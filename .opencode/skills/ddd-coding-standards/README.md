# DDD分层架构代码规范检查Skill

## 简介

这是一个用于检查SpringBoot DDD（领域驱动设计）分层架构代码规范的Claude Code Skill。

## 功能

- 自动检测项目的分层结构
- 检查层与层之间的依赖方向是否正确
- 验证领域层的独立性（DDD核心原则）
- 检查命名规范是否符合分层职责
- 识别跨层引用违规
- 生成详细的检查报告和改进建议

## 使用方法

```bash
# 检查当前目录
/ddd-layer-reviewer

# 检查指定项目
/ddd-layer-reviewer /path/to/project

# 或使用完整路径
/ddd-layer-reviewer ~/workspace/my-project
```

## DDD分层架构

```
┌─────────────────────────────────────────────────────┐
│                   接口层 (Interface)                 │
│  - Controller / Resource                            │
│  - DTO / Request / Response                         │
└─────────────────┬───────────────────────────────────┘
                  │ 依赖
                  ↓
┌─────────────────────────────────────────────────────┐
│                   应用层 (Application)               │
│  - ApplicationService / Facade                      │
│  - Command / Query                                  │
└─────────────────┬───────────────────────────────────┘
                  │ 依赖
                  ↓
┌─────────────────────────────────────────────────────┐
│                   领域层 (Domain)                    │
│  - Entity (聚合根、实体)                             │
│  - ValueObject (值对象)                             │
│  - DomainService (领域服务)                          │
│  - Repository接口                                    │
│  - DomainEvent (领域事件)                            │
│  ⚠️ 必须保持完全独立，不依赖任何其他层！              │
└─────────────────┬───────────────────────────────────┘
                  ↑
                  │ 实现
┌─────────────────┴───────────────────────────────────┐
│               基础设施层 (Infrastructure)             │
│  - RepositoryImpl (仓储实现)                         │
│  - External / Client (外部服务适配器)                 │
└─────────────────────────────────────────────────────┘
```

## 检查原则

### 1. 依赖方向原则
- 上层可以依赖下层
- 下层绝不能依赖上层
- 所有层都可以依赖领域层（但领域层不依赖任何层）

### 2. 领域层独立性原则（核心）
- 领域层是DDD的核心，必须保持100%独立
- 不依赖Spring框架（除基础注解外）
- 不依赖持久化框架
- 不依赖Web框架
- 只包含纯Java业务逻辑

### 3. 命名规范原则
- 类名应清晰表达其所在层的职责
- 避免跨层复用相同命名

## 检查输出

Skill会生成包含以下内容的检查报告：

1. **分层结构分析** - 识别项目的分层方式
2. **依赖方向检查** - 验证依赖关系是否正确
3. **领域层独立性检查** - 重点检查领域层是否纯净
4. **命名规范检查** - 验证类命名是否符合分层职责
5. **违规问题列表** - 列出所有发现的问题及位置
6. **评分统计** - 给出各维度的评分
7. **改进建议** - 针对问题的具体改进方案

## 示例输出

```markdown
# DDD分层架构代码规范检查报告

## 📁 项目信息
- 项目路径: /workspace/my-project
- 检查时间: 2024-01-23 10:30:00

## 🏗️ 分层结构分析
检测到标准DDD分层结构：
- com.example.interfaces (接口层)
- com.example.application (应用层)
- com.example.domain (领域层)
- com.example.infrastructure (基础设施层)

## ✅ 通过的检查
- ✅ 分层目录结构清晰
- ✅ 应用层依赖方向正确

## ⚠️ 发现的问题

### 严重问题
1. **领域层引用了Web框架**
   - 位置: `com/example/domain/entity/User.java:5`
   - 问题描述: UserEntity引入了org.springframework.web.bind.annotation.*
   - 违反原则: 领域层独立性原则
   - 建议修复: 移除Web注解，将DTO移至接口层

## 📊 评分统计
- 分层规范性: 90/100
- 领域层独立性: 70/100
- 命名规范性: 85/100
- 总体评分: 82/100
```

## 技术实现

- 使用 Glob 查找所有Java源文件
- 使用 Grep 搜索违规的包引用
- 使用 Read 读取可疑文件进行详细分析
- 生成结构化的检查报告
